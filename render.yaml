services:
  - type: web
    name: new_diamond_academy
    plan: free
    dockerfilePath: ./Dockerfile
    # Use the render entrypoint which waits for DB and runs migrations, then serves on $PORT
    startCommand: /usr/local/bin/render-entrypoint.sh
    routes:
      - path: /
        dest: /laravel/public/index.php
    env:
      - key: APP_ENV
        value: production
      - key: APP_KEY
        fromDatabase:
          name: app_key
      - key: LOG_CHANNEL
        value: stack

# Optional: provision a managed Postgres database on Render. Adjust region/plan as desired.
databases:
  - name: new_diamond_academy_db
    plan: starter
    region: oregon
    type: postgresql
